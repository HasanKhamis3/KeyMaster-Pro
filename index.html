تم إزالة النص الزائد الذي ظهر في أعلى الصفحة (الذي كان جزءاً من الرد السابق)، وتم تفعيل جميع أزرار الحفظ في قسم الإعدادات لتعمل بشكل فعلي (تقوم بحفظ البيانات في متصفحك وتظهر رسالة نجاح).

إليك الكود الكامل والمصحح:

```html
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام متابعة جودة التعليم والتعلم | وزارة التربية والتعليم</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --brand-red: #da291c;
            --brand-dark: #2b2b2b;
            --primary: #1e4078;
            --primary-light: #f0f4f8;
            --text-main: #333;
            --text-light: #777;
            --border-color: #e0e0e0;
            --sidebar-width: 260px;
            --success: #28a745;
            --danger: #dc3545;
            --shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        /* --- تنسيقات النظام العامة --- */
        * { box-sizing: border-box; outline: none; }
        body { margin: 0; background-color: #f7f9fc; font-family: 'Cairo', sans-serif; color: var(--text-main); }
        
        /* شاشة تسجيل الدخول */
        .login-wrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--brand-dark));
            display: flex; justify-content: center; align-items: center; z-index: 9999;
        }
        .login-card {
            background: white; padding: 40px; border-radius: 12px; width: 100%; max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center;
        }
        .login-card img { width: 80px; margin-bottom: 20px; }

        /* الهيكل الرئيسي */
        .app-container { display: flex; min-height: 100vh; }
        
        /* القائمة الجانبية */
        .sidebar {
            width: var(--sidebar-width); background: white; border-left: 1px solid var(--border-color);
            position: fixed; right: 0; top: 0; height: 100%; z-index: 100;
            display: flex; flex-direction: column; transition: 0.3s;
        }
        .sidebar-header { padding: 20px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid var(--primary-light); }
        .sidebar-header h2 { font-size: 1.1rem; margin: 0; color: var(--primary); font-weight: 700; }
        
        .nav-links { list-style: none; padding: 20px 0; margin: 0; flex: 1; }
        .nav-links li { margin-bottom: 5px; }
        .nav-links a {
            display: flex; align-items: center; padding: 12px 25px; color: var(--text-light);
            text-decoration: none; transition: 0.3s; font-weight: 600; font-size: 0.95rem; border-right: 3px solid transparent;
        }
        .nav-links a:hover, .nav-links a.active {
            color: var(--primary); background: var(--primary-light); border-right-color: var(--primary);
        }
        .nav-links a i { margin-left: 10px; width: 20px; text-align: center; }

        /* المحتوى الرئيسي */
        .main-content {
            margin-right: var(--sidebar-width); flex: 1; padding: 30px; width: calc(100% - var(--sidebar-width));
        }

        .top-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;
        }
        .user-profile { display: flex; align-items: center; gap: 10px; background: white; padding: 8px 15px; border-radius: 30px; box-shadow: var(--shadow); }
        .avatar { width: 35px; height: 35px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }

        .section-card {
            background: white; border-radius: 10px; padding: 25px; box-shadow: var(--shadow); margin-bottom: 25px;
            display: none; animation: fadeIn 0.4s ease;
        }
        .section-card.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card-title { font-size: 1.2rem; margin-bottom: 20px; color: var(--brand-dark); border-bottom: 2px solid var(--primary-light); padding-bottom: 10px; }

        /* عناصر التحكم */
        .btn {
            padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-family: inherit; font-weight: 600;
            transition: 0.3s; display: inline-flex; align-items: center; gap: 8px; font-size: 0.9rem;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-secondary { background: #e2e8f0; color: var(--text-main); }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        
        .form-control {
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 15px;
            font-family: inherit; font-size: 0.95rem; background-color: #fbfbfb; transition: 0.3s;
        }
        .form-control:focus { border-color: var(--primary); background: white; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }

        /* ==========================================================================
           تنسيقات الإعدادات (مطابقة للصور)
           ========================================================================== */
        
        .settings-layout {
            display: flex; gap: 20px; align-items: flex-start;
        }
        
        /* القائمة الجانبية للإعدادات */
        .settings-sidebar {
            width: 250px; background: white; border-radius: 10px; box-shadow: var(--shadow); overflow: hidden;
            flex-shrink: 0;
        }
        .settings-sidebar-header {
            padding: 15px; border-bottom: 1px solid #eee; font-weight: bold; color: var(--primary); text-align: center;
        }
        .settings-nav-item {
            display: block; padding: 12px 20px; color: #666; text-decoration: none; transition: 0.3s;
            cursor: pointer; border-bottom: 1px solid #f9f9f9;
        }
        .settings-nav-item:hover { background-color: #f8f9fa; color: var(--primary); }
        .settings-nav-item.active {
            background-color: var(--primary); color: white; border-right: 4px solid #15305b;
        }

        /* محتوى الإعدادات */
        .settings-content-area {
            flex-grow: 1; background: white; border-radius: 10px; box-shadow: var(--shadow); padding: 30px; min-height: 500px;
        }
        .setting-tab-pane { display: none; }
        .setting-tab-pane.active { display: block; animation: fadeIn 0.3s; }
        .setting-header { margin-bottom: 25px; padding-bottom: 10px; border-bottom: 1px solid #eee; color: var(--primary); font-size: 1.3rem; font-weight: 700; text-align: left; }

        /* منطقة رفع الشعار */
        .upload-area {
            border: 2px dashed #ccc; border-radius: 8px; padding: 40px; text-align: center;
            background-color: #fcfcfc; margin-bottom: 20px;
        }
        .upload-hint { color: #999; font-size: 0.85rem; margin-top: 10px; }

        /* بطاقات التوقيعات */
        .signatures-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .sig-card { border: 1px solid #eee; border-radius: 8px; padding: 20px; background: #fbfbfb; }
        .sig-card-header { font-weight: bold; color: var(--primary); margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 5px; text-align: right; }
        .sig-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 10px; }

        /* سجل النظام */
        .log-item {
            display: flex; justify-content: space-between; align-items: flex-start;
            padding: 15px; border: 1px solid #eee; border-radius: 8px; margin-bottom: 10px;
            background: #fff; position: relative; overflow: hidden;
        }
        .log-item::before {
            content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 4px; background-color: var(--primary);
        }
        .log-meta { font-size: 0.8rem; color: #888; margin-bottom: 5px; }
        .log-action { font-weight: bold; color: var(--primary); }
        .log-desc { color: #555; font-size: 0.9rem; }
        .log-icon {
            background: var(--primary); color: white; width: 30px; height: 30px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
        }

        /* معاينة التقرير المصغرة */
        .report-mini-preview {
            border: 1px solid #ddd; padding: 20px; border-radius: 8px; text-align: center; background: #fff;
            margin-top: 20px; position: relative;
        }
        
        /* تنسيقات التقرير للطباعة */
        .paper-preview-container { background: #525659; padding: 40px; overflow: auto; text-align: center; }
        .a4-page { background: white; width: 210mm; min-height: 297mm; margin: 0 auto; padding: 2.54cm; text-align: right; direction: rtl; font-family: 'Times New Roman', serif; box-shadow: 0 0 15px rgba(0,0,0,0.3); }
        
        /* طباعة */
        @media print {
            .sidebar, .top-header, .login-wrapper, .settings-layout { display: none !important; }
            .main-content { margin: 0; padding: 0; width: 100%; }
            .section-card { box-shadow: none; padding: 0; display: none; }
            #quality-report { display: block; }
            .btn-group-controls, .form-group { display: none; }
            .paper-preview-container { background: white; padding: 0; }
            .a4-page { margin: 0; box-shadow: none; width: 100%; page-break-after: always; }
        }

        /* تنبيهات */
        .toast {
            position: fixed; bottom: 20px; left: 20px; background: var(--success); color: white;
            padding: 15px 25px; border-radius: 5px; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateY(100px); transition: 0.3s; z-index: 9999;
        }
        .toast.show { transform: translateY(0); }

    </style>
</head>
<body>

    <div id="toast" class="toast">تم حفظ الإعدادات بنجاح</div>

    <div id="loginPage" class="login-wrapper">
        <div class="login-card">
            <img src="https://www.moe.gov.bh/img/logo.png" alt="وزارة التربية">
            <h2 style="color:var(--primary); margin-bottom:20px;">نظام متابعة جودة التعليم</h2>
            <form id="loginForm">
                <input type="text" class="form-control" placeholder="اسم المستخدم" required>
                <input type="password" class="form-control" placeholder="كلمة المرور" required>
                <button type="submit" class="btn btn-primary" style="width:100%; justify-content:center;">تسجيل الدخول</button>
            </form>
        </div>
    </div>

    <div id="app" class="app-container" style="display:none;">
        
        <aside class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-graduation-cap fa-2x" style="color:var(--primary)"></i>
                <div>
                    <h2>جودة التعليم</h2>
                    <small style="color:#777">وزارة التربية والتعليم</small>
                </div>
            </div>
            <ul class="nav-links">
                <li><a href="#" class="active" data-target="dashboard"><i class="fas fa-home"></i> لوحة التحكم</a></li>
                <li><a href="#" data-target="visits"><i class="fas fa-clipboard-check"></i> الزيارات الصفية</a></li>
                <li><a href="#" data-target="performance"><i class="fas fa-chart-line"></i> تقييم الأداء</a></li>
                <li><a href="#" data-target="quality-report"><i class="fas fa-file-word"></i> تقرير الجودة</a></li>
                <li><a href="#" data-target="settings"><i class="fas fa-cog"></i> الإعدادات</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <header class="top-header">
                <h2 id="pageTitle" style="margin:0;">لوحة التحكم</h2>
                <div class="user-profile">
                    <span>أ. محمد أحمد</span>
                    <div class="avatar">م</div>
                    <button id="logoutBtn" class="btn btn-secondary btn-sm" style="padding: 5px 10px;"><i class="fas fa-sign-out-alt"></i></button>
                </div>
            </header>

            <section id="dashboard" class="section-card active">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom:30px;">
                    <div style="background:white; padding:20px; border-radius:10px; border-top:4px solid var(--primary); box-shadow:var(--shadow);">
                        <h3>120</h3><p style="color:#777">زيارة صفية</p>
                    </div>
                    <div style="background:white; padding:20px; border-radius:10px; border-top:4px solid var(--success); box-shadow:var(--shadow);">
                        <h3>15</h3><p style="color:#777">معلم متميز</p>
                    </div>
                    <div style="background:white; padding:20px; border-radius:10px; border-top:4px solid var(--danger); box-shadow:var(--shadow);">
                        <h3>8</h3><p style="color:#777">بحاجة لدعم</p>
                    </div>
                </div>
                <div style="height: 300px;"><canvas id="dashboardChart"></canvas></div>
            </section>

            <section id="visits" class="section-card"><h3 class="card-title">سجل الزيارات الصفية</h3></section>
            <section id="performance" class="section-card"><h3 class="card-title">تحليل الأداء</h3></section>

            <section id="quality-report" class="section-card">
                <div class="card-title" style="display:flex; justify-content:space-between; align-items:center;">
                    <span>تقرير متابعة جودة التعليم والتعلم</span>
                    <div class="btn-group-controls no-print">
                        <button class="btn btn-primary" onclick="window.print()"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <div class="paper-preview-container" id="printArea">
                    </div>
            </section>

            <section id="settings" style="display:none;">
                 <div class="settings-layout">
                    
                    <div class="settings-sidebar">
                        <div class="settings-sidebar-header">الإعدادات</div>
                        <div class="settings-nav-item active" onclick="switchSettingTab('general', this)">الإعدادات العامة</div>
                        <div class="settings-nav-item" onclick="switchSettingTab('report-config', this)">إعدادات تقرير الجودة</div>
                        <div class="settings-nav-item" onclick="switchSettingTab('signatures', this)">إعدادات التوقيعات</div>
                        <div class="settings-nav-item" onclick="switchSettingTab('visitors', this)">ترتيب الزوار</div>
                        <div class="settings-nav-item" onclick="switchSettingTab('footer', this)">إعدادات التذييل</div>
                        <div class="settings-nav-item" onclick="switchSettingTab('logs', this)">سجل النظام</div>
                    </div>

                    <div class="settings-content-area">
                        
                        <div id="general" class="setting-tab-pane active">
                            <h3 class="setting-header">الإعدادات العامة</h3>
                            <div class="form-group">
                                <label>اسم المدرسة</label>
                                <input type="text" id="schoolNameInput" class="form-control" placeholder="أدخل اسم المدرسة" value="مدرسة مدينة حمد الابتدائية للبنات">
                            </div>
                            <div class="form-group">
                                <label>العام الدراسي</label>
                                <input type="text" id="yearInput" class="form-control" value="2025 / 2026م">
                            </div>
                            <div class="form-group">
                                <label>شعار الوزارة</label>
                                <div class="upload-area">
                                    <button class="btn btn-success" onclick="document.getElementById('fileInput').click()"><i class="fas fa-upload"></i> تحميل شعار الوزارة</button>
                                    <input type="file" id="fileInput" style="display:none" onchange="alert('تم تحديد الصورة')">
                                    <div class="upload-hint">الحجم المقترح: 200x80 بكسل</div>
                                </div>
                            </div>
                            <div style="text-align: left;">
                                <button class="btn btn-success" onclick="saveData('general')">حفظ الإعدادات</button>
                            </div>
                        </div>

                        <div id="report-config" class="setting-tab-pane">
                            <h3 class="setting-header">إعدادات تقرير جودة التعليم</h3>
                            <div class="form-group">
                                <label>الشهر الافتراضي للتقرير</label>
                                <select id="monthSelect" class="form-control">
                                    <option>سبتمبر</option>
                                    <option selected>أكتوبر</option>
                                    <option>نوفمبر</option>
                                    <option>ديسمبر</option>
                                </select>
                            </div>
                            <label>معاينة تقرير الجودة</label>
                            <div class="report-mini-preview">
                                <div style="position: absolute; left: 20px; top: 20px;"><img src="https://www.moe.gov.bh/img/logo.png" width="80px" alt="شعار الوزارة"></div>
                                <br><br>
                                <div class="preview-title" style="font-weight:bold; font-size:1.2rem;">تقرير متابعة جودة التعليم والتعلم للقيادة العليا والوسطى</div>
                                <br>
                                <div class="preview-title" style="font-size:1rem;">لمدرسة <span style="font-weight:bold">[اسم المدرسة]</span></div>
                                <div class="preview-title" style="font-size:0.9rem;">شهر سبتمبر</div>
                                <div class="preview-title" style="font-size:0.9rem;">العام الدراسي 2025 / 2026م</div>
                                <br><br>
                                <hr style="margin: 20px 0;">
                                <div style="display:flex; justify-content:space-between; font-size:0.8rem; padding: 0 20px;">
                                    <div style="text-align:center;">يعتمد، مدير/ة المدرسة<br>[اسم مدير المدرسة]</div>
                                    <div style="color:#999; margin-top:10px;">[التذييل سيظهر هنا]</div>
                                    <div style="text-align:center;">إعداد المدير/ة المساعد/ة<br>[اسم المدير المساعد]</div>
                                </div>
                            </div>
                            <div style="text-align: left; margin-top:20px;">
                                <button class="btn btn-success" onclick="saveData('report')">حفظ الإعدادات</button>
                            </div>
                        </div>

                        <div id="signatures" class="setting-tab-pane">
                            <h3 class="setting-header">إعدادات التوقيعات</h3>
                            <p style="color:#777; margin-bottom:20px;">تحديد الأشخاص المسؤولين عن توقيع التقرير من القيادة العليا</p>
                            
                            <div class="signatures-grid">
                                <div class="sig-card">
                                    <div class="sig-card-header">المدير/ة المساعد/ة</div>
                                    <label>اختر المدير/ة المساعد/ة</label>
                                    <select id="assistantSelect" class="form-control">
                                        <option>اختر اسم المدير المساعد</option>
                                        <option selected>أ. فاطمة علي</option>
                                    </select>
                                    <div class="sig-actions">
                                        <button class="btn btn-primary" style="font-size:0.8rem;" onclick="alert('تم إضافة الاسم')">إضافة</button>
                                        <button class="btn btn-danger" style="font-size:0.8rem;" onclick="alert('تم إزالة الاسم')">إزالة</button>
                                    </div>
                                </div>

                                <div class="sig-card">
                                    <div class="sig-card-header">مدير/ة المدرسة</div>
                                    <label>اختر مدير/ة المدرسة</label>
                                    <select id="principalSelect" class="form-control">
                                        <option>اختر اسم مدير المدرسة</option>
                                        <option selected>أ. مريم حسن</option>
                                    </select>
                                    <div class="sig-actions">
                                        <button class="btn btn-primary" style="font-size:0.8rem;" onclick="alert('تم إضافة الاسم')">إضافة</button>
                                        <button class="btn btn-danger" style="font-size:0.8rem;" onclick="alert('تم إزالة الاسم')">إزالة</button>
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: left; margin-top:20px;">
                                <button class="btn btn-success" onclick="saveData('signatures')">حفظ الإعدادات</button>
                            </div>
                        </div>

                        <div id="visitors" class="setting-tab-pane">
                            <h3 class="setting-header">ترتيب الزوار في التقرير</h3>
                            <p style="color:#777;">حدد ترتيب ظهور أسماء الزوار في تقرير الزيارات الصفية</p>
                            
                            <div style="margin-bottom:20px;">
                                <label style="text-align:right">القيادة العليا</label>
                                <div style="border-bottom:1px solid #eee; padding-bottom:10px;"></div>
                            </div>
                             <div style="margin-bottom:20px;">
                                <label style="text-align:right">القيادة الوسطى</label>
                                <div style="border-bottom:1px solid #eee; padding-bottom:10px;"></div>
                            </div>
                            
                            <div style="text-align: left;">
                                <button class="btn btn-success" onclick="saveData('visitors')">حفظ الترتيب</button>
                            </div>
                        </div>

                        <div id="footer" class="setting-tab-pane">
                            <h3 class="setting-header">إعدادات تذييل التقرير</h3>
                            <div class="form-group">
                                <label>نص التذييل <small style="color:#999; font-weight:normal;">(النص الذي سيظهر في تذييل كل صفحة)</small></label>
                                <textarea id="footerText" class="form-control" rows="4" placeholder="أدخل نص التذييل الذي سيظهر في أسفل كل صفحة من التقرير"></textarea>
                            </div>
                            <div class="form-group">
                                <label>محاذاة التذييل</label>
                                <select class="form-control">
                                    <option>وسط</option>
                                    <option>يمين</option>
                                    <option>يسار</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>حجم الخط</label>
                                <select class="form-control">
                                    <option>10 نقطة</option>
                                    <option selected>12 نقطة</option>
                                    <option>14 نقطة</option>
                                </select>
                            </div>
                            <div style="text-align: left;">
                                <button class="btn btn-success" onclick="saveData('footer')">حفظ إعدادات التذييل</button>
                            </div>
                        </div>

                        <div id="logs" class="setting-tab-pane">
                            <h3 class="setting-header">سجل النظام</h3>
                            <p style="color:#777;">عرض جميع الأنشطة التي تمت في النظام</p>
                            
                            <div class="form-group">
                                <label>تصفية السجل:</label>
                                <select class="form-control">
                                    <option>جميع الأنشطة</option>
                                    <option>تسجيل الدخول</option>
                                    <option>تعديل بيانات</option>
                                </select>
                            </div>

                            <div style="max-height: 300px; overflow-y: auto; margin-bottom:20px;">
                                <div class="log-item">
                                    <div style="flex-grow:1;">
                                        <div class="log-meta">2026/1/6 1:37:40 م</div>
                                        <div class="log-action">مدير النظام</div>
                                        <div class="log-desc">تنقل إلى قسم الإعدادات</div>
                                    </div>
                                    <div class="log-icon"><i class="fas fa-history"></i></div>
                                </div>
                                <div class="log-item">
                                    <div style="flex-grow:1;">
                                        <div class="log-meta">2026/1/6 1:16:52 م</div>
                                        <div class="log-action">مدير النظام</div>
                                        <div class="log-desc">تنقل إلى قسم تقرير جودة التعليم</div>
                                    </div>
                                    <div class="log-icon"><i class="fas fa-history"></i></div>
                                </div>
                            </div>

                            <div style="text-align: left; display:flex; justify-content:flex-end; gap:10px;">
                                <button class="btn btn-primary" onclick="alert('تم تحديث السجل')">تحديث السجل</button>
                                <button class="btn btn-danger" onclick="alert('تم مسح السجل')">مسح السجل</button>
                                <button class="btn btn-success" onclick="alert('جاري التصدير...')">تصدير السجل</button>
                            </div>
                        </div>

                    </div>
                 </div>
            </section>

        </main>
    </div>

    <script>
        // --- تهيئة النظام ---
        document.addEventListener('DOMContentLoaded', () => {
            // التحقق من تسجيل الدخول
            if(localStorage.getItem('userLogged')) {
                showApp();
            }

            // التنقل الرئيسي
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.querySelectorAll('.nav-links a').forEach(l => l.classList.remove('active'));
                    // إخفاء جميع الأقسام بما فيها الإعدادات الخاصة
                    document.querySelectorAll('.section-card').forEach(s => s.classList.remove('active'));
                    document.getElementById('settings').style.display = 'none';

                    // تفعيل الرابط
                    e.target.closest('a').classList.add('active');
                    const targetId = e.target.closest('a').dataset.target;
                    
                    if (targetId === 'settings') {
                        document.getElementById('settings').style.display = 'block';
                    } else {
                        document.getElementById(targetId).classList.add('active');
                    }
                    
                    document.getElementById('pageTitle').innerText = e.target.innerText;
                });
            });

            // تسجيل الدخول
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                localStorage.setItem('userLogged', true);
                showApp();
            });

            document.getElementById('logoutBtn').addEventListener('click', () => {
                localStorage.removeItem('userLogged');
                location.reload();
            });

            initDashboardChart();
            generateReportView();
        });

        // --- وظيفة التبديل بين تبويبات الإعدادات ---
        function switchSettingTab(tabId, element) {
            document.querySelectorAll('.setting-tab-pane').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.settings-nav-item').forEach(el => el.classList.remove('active'));

            document.getElementById(tabId).classList.add('active');
            element.classList.add('active');
        }

        // --- وظيفة حفظ الإعدادات (تعمل الآن) ---
        function saveData(section) {
            let message = "تم حفظ الإعدادات بنجاح";
            
            // محاكاة الحفظ في التخزين المحلي
            if(section === 'general') {
                localStorage.setItem('schoolName', document.getElementById('schoolNameInput').value);
                localStorage.setItem('acadYear', document.getElementById('yearInput').value);
                message = "تم حفظ الإعدادات العامة";
            } else if (section === 'report') {
                localStorage.setItem('reportMonth', document.getElementById('monthSelect').value);
                message = "تم حفظ إعدادات التقرير";
            } else if (section === 'signatures') {
                message = "تم تحديث قائمة الموقعين";
            } else if (section === 'footer') {
                localStorage.setItem('footerText', document.getElementById('footerText').value);
                message = "تم حفظ نص التذييل";
            }

            // إظهار رسالة النجاح
            const toast = document.getElementById('toast');
            toast.innerText = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function showApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('app').style.display = 'flex';
        }

        function initDashboardChart() {
            const ctx = document.getElementById('dashboardChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['العربية', 'الرياضيات', 'العلوم', 'الإنجليزي', 'الاجتماعيات'],
                    datasets: [{
                        label: 'عدد الزيارات',
                        data: [12, 19, 3, 5, 2],
                        backgroundColor: '#1e4078'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }

        function generateReportView() {
            const container = document.getElementById('printArea');
            let html = `
            <div class="a4-page">
                <div style="text-align:center;"><img src="https://www.moe.gov.bh/img/logo.png" style="width:120px;"></div>
                <br><br>
                <div style="border:3px double #000; padding:20px; text-align:center;">
                    <h1>تقرير متابعة جودة التعليم والتعلم</h1>
                    <h2>للمدرسة ـــــــــــــــــــــــــــــــــ</h2>
                </div>
            </div>`;
            container.innerHTML = html;
        }
    </script>
</body>
</html>

```
